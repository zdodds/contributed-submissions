#
# hw5pr1births_cleaner:  birth classification by month + day    (above/below median: 190942)



# libraries!
import numpy as np      # numpy is python's "array" library
import pandas as pd     # pandas is python's "data" library ("dataframe" == spreadsheet)


#
# *** suggestion ***  
# 
#       +++ copy-paste-and-alter from the iris-cleaning notebook to here +++
#
# this approach has the advantage of more deeply "digesting" the iris workflow...
#      ... altering the parts that don't transfer, and taking the parts that do!
#

# eventually you'll get rid of the _births_ column, that can be here or in the modeling notebook
# read in our spreadsheet (csv)
# read in the spreadsheet (csv)
# read in the spreadsheet (csv)
filename = 'births.csv'
df = pd.read_csv(filename)  # adjust encoding if necessary
print(f"{filename} : file read into a pandas dataframe.")

# define row and column for clarity
row = 0        
column = 1     

# drop the final column if it exists (adjust column name if different)
unwanted_column = 'from http://chmullig.com/2012/06/births-by-day-of-year/'
if unwanted_column in df.columns:
    df_clean1 = df.drop(unwanted_column, axis=column)
else:
    df_clean1 = df.copy()

df_clean1

# drop all rows with missing data (nan values)
df_clean2 = df_clean1.dropna()
df_clean2.info()
df_clean2

# make a copy before adding new columns
df_clean3 = df_clean2.copy()

# convert 'above/below median' column to numerical representation
def convert_above_below(value):
    return 1 if value.strip().lower() == 'above' else 0

df_clean3['above_median'] = df_clean3['above/below median'].apply(convert_above_below)

df_clean3.drop(columns=['above/below median'], inplace=true)

df_tidy = df_clean3

# construct the new filename
cleaned_filename = filename.replace('.csv', '_cleaned.csv')
print(f"cleaned_filename is {cleaned_filename}")

# save the cleaned dataframe
df_tidy.to_csv(cleaned_filename, index=false)  # no "index" column

# re-read and verify the cleaned data
df_tidy_reread = pd.read_csv(cleaned_filename)
print(f"{cleaned_filename} : file read into a pandas dataframe.")
df_tidy_reread





